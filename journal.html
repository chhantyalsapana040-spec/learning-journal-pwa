<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Weekly Journal | Learning Journal</title>
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>
  <header>
    <nav></nav>
  </header>

  <main>
    <section class="reflection-section">
      <h2>Reflective Journal</h2>

      <form id="myForm" name="myForm" onsubmit="return checkReflection()">
        <label for="fname">Week Title:</label><br>
        <input type="text" id="fname" name="fname" required><br><br>

        <label for="reflection">Reflection:</label><br>
        <textarea id="reflection" name="reflection" minlength="10" required
          placeholder="What did you learn this week? What did you find challenging?"></textarea><br><br>

        <input type="submit" value="Submit">
        <input type="reset" value="Reset">
        <input type="button" value="Clear All" onclick="clearAll()">
      </form>

      <h3>Total Reflections: <span id="reflectionCount">0</span></h3>

      <h2>Previous Reflections</h2>
      <div id="viewAll"></div>
    </section>

    <section class="journal-section">
      <h1>Weekly Journal</h1>
      <p>Your weekly reflections from JSON appear above. These entries below can now be removed since they are fully stored inside reflections.json.</p>
    </section>
  </main>

  <footer>
    <p>Â© 2025 Sapana Chhantyal | University for the Creative Arts</p>
  </footer>

<script>
  document.addEventListener("DOMContentLoaded", () => {

    // --- LOAD REFLECTIONS FROM JSON ---
    fetch("backend/reflections.json")
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById("viewAll");
        const counter = document.getElementById("reflectionCount");

        counter.textContent = data.length; // Set reflection count

        data.forEach(entry => {
          const div = document.createElement("div");
          div.classList.add("reflection-card");

          div.innerHTML = `
            <h3>${entry.week}</h3>
            <p><em>${entry.date}</em></p>
            <p>${entry.reflection}</p>
            <hr>
          `;

          container.appendChild(div);
        });
      });

 
    window.checkReflection = function () {
      const week = document.getElementById("fname").value.trim();
      const reflection = document.getElementById("reflection").value.trim();

      if (week === "" || reflection.length < 10) {
        alert("Please enter a valid week title and a reflection of at least 10 characters.");
        return false;
      }

      alert("To save a reflection, run save_entry.py (this form does not save JSON).");
      return false;
    };

   
    window.clearAll = function () {
      document.getElementById("fname").value = "";
      document.getElementById("reflection").value = "";
    };

  });
</script>

</body>
</html>
